# Users

## Объект пользователя

Messembed представляет собою встраиваемый сервис чатов. Идея в том, что пользователи в существующем приложении должны иметь возможность общаться с помощью данного сервиса. Для достижения этого результата нужно интегрировать текущую базу пользователей и новых пользователей с системой Messembed. Для этого предусмотрен механизм ведения пользователей. 

### Представление

<table>
  <thead>
    <tr>
      <th style="text-align:left">&#x41F;&#x43E;&#x43B;&#x435;</th>
      <th style="text-align:left">&#x422;&#x438;&#x43F;</th>
      <th style="text-align:left">&#x41E;&#x43F;&#x438;&#x441;&#x430;&#x43D;&#x438;&#x435;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left"><code>_id</code>
      </td>
      <td style="text-align:left"><code>string</code>
      </td>
      <td style="text-align:left">
        <p>&#x423;&#x43D;&#x438;&#x43A;&#x430;&#x43B;&#x44C;&#x43D;&#x44B;&#x439;
          &#x438;&#x434;&#x435;&#x43D;&#x442;&#x438;&#x444;&#x438;&#x43A;&#x430;&#x442;&#x43E;&#x440;
          &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x44F;
          &#x432; &#x432;&#x430;&#x448;&#x435;&#x43C; &#x43F;&#x440;&#x438;&#x43B;&#x43E;&#x436;&#x435;&#x43D;&#x438;&#x438;.</p>
        <p>&#x417;&#x43D;&#x430;&#x447;&#x435;&#x43D;&#x438;&#x435; &#x437;&#x430;&#x434;&#x430;&#x435;&#x442;&#x441;&#x44F;
          &#x43F;&#x440;&#x438; &#x438;&#x43D;&#x442;&#x435;&#x433;&#x440;&#x438;&#x440;&#x43E;&#x432;&#x430;&#x43D;&#x438;&#x438;
          &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x44F;.</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left"><code>createdAt</code>
      </td>
      <td style="text-align:left"><code>string</code> (ISO 8601)</td>
      <td style="text-align:left">
        <p>&#x414;&#x430;&#x442;&#x430; &#x438;&#x43D;&#x442;&#x435;&#x433;&#x440;&#x430;&#x446;&#x438;&#x438;
          &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x44F;
          &#x441; Messembed.</p>
        <p>&#x417;&#x43D;&#x430;&#x447;&#x435;&#x43D;&#x438;&#x435; &#x43D;&#x435;
          &#x437;&#x430;&#x434;&#x430;&#x435;&#x442;&#x441;&#x44F;.</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left"><code>updatedAt</code>
      </td>
      <td style="text-align:left"><code>string</code> (ISO 8601)</td>
      <td style="text-align:left">
        <p>&#x414;&#x430;&#x442;&#x430; &#x43E;&#x431;&#x43D;&#x43E;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x44F;
          &#x434;&#x430;&#x43D;&#x43D;&#x44B;&#x445; &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x44F;.</p>
        <p>&#x417;&#x43D;&#x430;&#x447;&#x435;&#x43D;&#x438;&#x435; &#x43D;&#x435;
          &#x437;&#x430;&#x434;&#x430;&#x435;&#x442;&#x441;&#x44F;.</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left"><code>deletedAt</code>
      </td>
      <td style="text-align:left"><code>string</code> (ISO 8601)</td>
      <td style="text-align:left">
        <p>&#x414;&#x430;&#x442;&#x430; &#x443;&#x434;&#x430;&#x43B;&#x435;&#x43D;&#x438;&#x44F;
          &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x44F;,
          &#x435;&#x441;&#x43B;&#x438; &#x43E;&#x43D; &#x443;&#x434;&#x430;&#x43B;&#x435;&#x43D;.
          &#x418;&#x43D;&#x430;&#x447;&#x435; <code>null</code> .</p>
        <p>&#x417;&#x43D;&#x430;&#x447;&#x435;&#x43D;&#x438;&#x435; &#x43D;&#x435;
          &#x437;&#x430;&#x434;&#x430;&#x435;&#x442;&#x441;&#x44F;.</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left"><code>externalMetadata</code>
      </td>
      <td style="text-align:left"><code>json</code>
      </td>
      <td style="text-align:left">
        <p>&#x41F;&#x440;&#x43E;&#x438;&#x437;&#x432;&#x43E;&#x43B;&#x44C;&#x43D;&#x44B;&#x435;
          &#x434;&#x430;&#x43D;&#x43D;&#x44B;&#x435; &#x43E; &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x435;
          &#x432; &#x432;&#x438;&#x434;&#x435; &#x43A;&#x43B;&#x44E;&#x447;-&#x437;&#x43D;&#x430;&#x447;&#x435;&#x43D;&#x438;&#x435;
          &#x441; &#x432;&#x43E;&#x437;&#x43C;&#x43E;&#x436;&#x43D;&#x44B;&#x43C;&#x438;
          &#x432;&#x43B;&#x43E;&#x436;&#x435;&#x43D;&#x438;&#x44F;&#x43C;&#x438;.
          &#x42D;&#x442;&#x438; &#x434;&#x430;&#x43D;&#x43D;&#x44B;&#x435; &#x43C;&#x43E;&#x433;&#x443;&#x442;
          &#x432;&#x438;&#x434;&#x435;&#x442;&#x44C; &#x432;&#x441;&#x435; &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x438;.</p>
        <p>&#x417;&#x43D;&#x430;&#x447;&#x435;&#x43D;&#x438;&#x435; &#x43C;&#x43E;&#x436;&#x435;&#x442;
          &#x437;&#x430;&#x434;&#x430;&#x432;&#x430;&#x442;&#x44C;&#x441;&#x44F;
          &#x43F;&#x440;&#x438; &#x438;&#x43D;&#x442;&#x435;&#x433;&#x440;&#x438;&#x440;&#x43E;&#x432;&#x430;&#x43D;&#x438;&#x438;
          &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x44F;
          &#x438;&#x43B;&#x438; &#x43F;&#x440;&#x438; &#x43E;&#x431;&#x43D;&#x43E;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x438;
          &#x435;&#x433;&#x43E; &#x434;&#x430;&#x43D;&#x43D;&#x44B;&#x445;.</p>
        <p>&#x422;&#x443;&#x442; &#x43C;&#x43E;&#x436;&#x43D;&#x43E; &#x445;&#x440;&#x430;&#x43D;&#x438;&#x442;&#x44C;,
          &#x43A; &#x43F;&#x440;&#x438;&#x43C;&#x435;&#x440;&#x443;, &#x438;&#x43C;&#x44F;
          &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x44F;,
          &#x435;&#x433;&#x43E; &#x430;&#x432;&#x430;&#x442;&#x430;&#x440; &#x438;
          &#x43F;&#x440;&#x43E;&#x447;&#x443;&#x44E; &#x43E;&#x431;&#x449;&#x435;&#x434;&#x43E;&#x441;&#x442;&#x443;&#x43F;&#x43D;&#x443;&#x44E;
          &#x438;&#x43D;&#x444;&#x43E;&#x440;&#x43C;&#x430;&#x446;&#x438;&#x44E;.</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left"><code>privateExternalMetadata</code>
      </td>
      <td style="text-align:left"><code>json</code>
      </td>
      <td style="text-align:left">
        <p>&#x41F;&#x440;&#x43E;&#x438;&#x437;&#x432;&#x43E;&#x43B;&#x44C;&#x43D;&#x44B;&#x435;
          &#x434;&#x430;&#x43D;&#x43D;&#x44B;&#x435; &#x43E; &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x435;
          &#x432; &#x432;&#x438;&#x434;&#x435; &#x43A;&#x43B;&#x44E;&#x447;-&#x437;&#x43D;&#x430;&#x447;&#x435;&#x43D;&#x438;&#x435;
          &#x441; &#x432;&#x43E;&#x437;&#x43C;&#x43E;&#x436;&#x43D;&#x44B;&#x43C;&#x438;
          &#x432;&#x43B;&#x43E;&#x436;&#x435;&#x43D;&#x438;&#x44F;&#x43C;&#x438;.&#x42D;&#x442;&#x438;
          &#x434;&#x430;&#x43D;&#x43D;&#x44B;&#x435; &#x43C;&#x43E;&#x436;&#x435;&#x442;
          &#x443;&#x432;&#x438;&#x434;&#x435;&#x442;&#x44C; &#x442;&#x43E;&#x43B;&#x44C;&#x43A;&#x43E;
          &#x441;&#x435;&#x440;&#x432;&#x435;&#x440; (admin) &#x43F;&#x440;&#x438;&#x43B;&#x43E;&#x436;&#x435;&#x43D;&#x438;&#x44F;.</p>
        <p>&#x417;&#x43D;&#x430;&#x447;&#x435;&#x43D;&#x438;&#x435; &#x43C;&#x43E;&#x436;&#x435;&#x442;
          &#x437;&#x430;&#x434;&#x430;&#x432;&#x430;&#x442;&#x44C;&#x441;&#x44F;
          &#x43F;&#x440;&#x438; &#x438;&#x43D;&#x442;&#x435;&#x433;&#x440;&#x438;&#x440;&#x43E;&#x432;&#x430;&#x43D;&#x438;&#x438;
          &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x44F;
          &#x438;&#x43B;&#x438; &#x43F;&#x440;&#x438; &#x43E;&#x431;&#x43D;&#x43E;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x438;
          &#x435;&#x433;&#x43E; &#x434;&#x430;&#x43D;&#x43D;&#x44B;&#x445;.</p>
      </td>
    </tr>
  </tbody>
</table>

## Создание пользователя \(интегрирование пользователя\)

{% hint style="info" %}
Рекомендация: лучше интегрировать пользователя прямо после завершения регистрации в вашем приложении. В таком все пользователи будут изначально иметь возможность взаимодействовать с системой чатов Messembed.
{% endhint %}

{% hint style="info" %}
Рекомендация: если у вашего приложения уже есть база пользователей то лучше предварительно интегрировать их с сервисом Messembed.
{% endhint %}

### Параметры

| Параметр | Тип | Обязательно |
| :--- | :--- | :--- |
| `_id` | string | Да |
| `externalMetadata` | json | Нет |
| `privateExternalMetadata` | json | Нет |

### Пример создания пользователя через SDK

```typescript
import {MessembedAdminSDK, User} from 'messembed-sdk';
const messemgedAdminSdk = new MessembedAdminSDK(...);

const user: User = await messemgedAdminSdk.createUser({
    _id: '1',
    externalMetadata: {
        name: 'John',
        someOtherMetadata: '...'
    },
    privateExternalMetadata: {},
});

```

## Получение Access Token для пользователя

Для того, чтобы пользователь вашего приложения смог взаимодействовать с сервисом Messembed ему нужен ключ доступа \(access token\). Ключ доступа может создать только сервер \(админ системы\).

После создания ключа доступа его нужно передать пользователю \(на фронтенд/мобильное приложение\). В дальнейшем пользователь будет использовать этот ключ доступа для запросов в сервис Messembed.

{% hint style="info" %}
Рекомендация: ключ доступа лучше выпускать либо при прохождении авторизации в вашей системе, либо после нее.
{% endhint %}

### Получение Access Token пользователя

```typescript
import {MessembedAdminSDK, AccessToken} from 'messembed-sdk';
const messemgedAdminSdk = new MessembedAdminSDK(...);

// Для получения access token для пользователя передаем в метод
// createAccessToken 
const accessToken: AccessToken = await messemgedAdminSdk.createAccessToken('1');

console.log(accessToken.accessToken); // 'sdfgszxcva...'
```



